I"“k<p>ì´ì „ì— <strong><a href="/2020/02/09/jpa1">ì´ ê¸€</a></strong>ì—ì„œ <strong>JPAë¥¼</strong> ë‹¤ë¤˜ì—ˆìŠµë‹ˆë‹¤. <strong>Spring Boot</strong>ì—ì„œì˜ <strong>JPA</strong>ì‚¬ìš©ì€ ê·¸ ë•Œì˜ <strong>JPA</strong>ì‚¬ìš©ê³¼ëŠ” ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ <strong>JPA</strong>ì˜ ë™ì‘ì„ ì¢€ë” ìì„¸í•˜ê²Œ ì•Œê³ ì <strong>EntityManager</strong>ë¥¼ ì´ìš©í•´ ìˆ˜ë™ì ìœ¼ë¡œ <strong>Transaction</strong>ì„ ë‹¤ë¤˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ <strong>Spring</strong>ì—ì„œ <strong>JPA</strong>ë¥¼ ì¢…ë” í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ê³ ì <strong>Spring Data JPA</strong>ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ <strong>Spring Data JPA</strong>ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì¼ë ¨ì˜ ê³¼ì •ë“¤ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ê¸° ë•Œë¬¸ì— ë”ìš± í¸ë¦¬í•œ ì‚¬ìš©ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì‹œê°„ì—ëŠ” <strong>Spring Data JPA</strong>ì— ëŒ€í•´ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="1spring-data-jpa">1.Spring Data JPA</h2>

<p>Spring Data JPAì˜ í•µì‹¬ì€ <code class="language-plaintext highlighter-rouge">Repository</code>ì— ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ê·¸ë¦¼ì„ ë³´ê² ìŠµë‹ˆë‹¤.
<img src="/img/in-post/spring-data/interface.png" /></p>

<p><strong>Repository</strong>ëŠ” <strong>Spring Data Interface</strong>ì˜ ì¤‘ì•™ ì €ì¥ì†Œ ì—­í• ì„ í•©ë‹ˆë‹¤. TëŠ” <strong>ì—”í„°í‹°ì˜ í´ë˜ìŠ¤</strong> ìœ í˜•ì´ê³ , IdëŠ” <strong>@Idì˜ íƒ€ì…</strong>ì…ë‹ˆë‹¤. ì•„ë˜ëŠ” <code class="language-plaintext highlighter-rouge">CrudRepository</code>ì˜ ëª¨ìŠµì…ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="nd">@NoRepositoryBean</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="no">T</span><span class="o">,</span> <span class="no">ID</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">Repository</span><span class="o">&lt;</span><span class="no">T</span><span class="o">,</span> <span class="no">ID</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="o">&lt;</span><span class="no">S</span> <span class="kd">extends</span> <span class="no">T</span><span class="o">&gt;</span> <span class="no">S</span> <span class="nf">save</span><span class="o">(</span><span class="no">S</span> <span class="n">var1</span><span class="o">);</span>

    <span class="o">&lt;</span><span class="no">S</span> <span class="kd">extends</span> <span class="no">T</span><span class="o">&gt;</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">S</span><span class="o">&gt;</span> <span class="nf">saveAll</span><span class="o">(</span><span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">S</span><span class="o">&gt;</span> <span class="n">var1</span><span class="o">);</span>

    <span class="nc">Optional</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="no">ID</span> <span class="n">var1</span><span class="o">);</span>

    <span class="kt">boolean</span> <span class="nf">existsById</span><span class="o">(</span><span class="no">ID</span> <span class="n">var1</span><span class="o">);</span>

    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">();</span>

    <span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">findAllById</span><span class="o">(</span><span class="nc">Iterable</span><span class="o">&lt;</span><span class="no">ID</span><span class="o">&gt;</span> <span class="n">var1</span><span class="o">);</span>

    <span class="kt">long</span> <span class="nf">count</span><span class="o">();</span>

    <span class="kt">void</span> <span class="nf">deleteById</span><span class="o">(</span><span class="no">ID</span> <span class="n">var1</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="no">T</span> <span class="n">var1</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">deleteAll</span><span class="o">(</span><span class="nc">Iterable</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="no">T</span><span class="o">&gt;</span> <span class="n">var1</span><span class="o">);</span>

    <span class="kt">void</span> <span class="nf">deleteAll</span><span class="o">();</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>CrudRepository</strong>ë¥¼ ì‚´í´ë³´ë©´ ìš°ë¦¬ê°€ êµ¬í˜„í•´ì•¼ë  ì¿¼ë¦¬ë“¤ì´ ê¸°ë³¸ì ìœ¼ë¡œ êµ¬í˜„ì´ ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì ì‹œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.<br />
1) <strong>save</strong> : ì£¼ì–´ì§„ ì—”í„°í‹°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.<br />
2) <strong>findById</strong> : ì£¼ì–´ì§„ Idë¡œ ì‹ë³„ëœ ì—”í„°í‹°ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.<br />
3) <strong>findAll</strong> : ëª¨ë“  ì—”í„°í‹°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.<br />
4) <strong>count</strong> : ì—”í„°í‹°ì˜ ìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.<br />
5) <strong>delete</strong> : ì£¼ì–´ì§„ ì—”í„°í‹°ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.<br />
6) <strong>existById</strong> : ì£¼ì–´ì§„ Idë¥¼ ê°€ì§„ ì—”í„°í‹°ê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>

<p>ìš°ë¦¬ê°€ ì¼ë°˜ì ìœ¼ë¡œ êµ¬í˜„í•´ì•¼í•  ì¿¼ë¦¬ë“¤ì´ ë¯¸ë¦¬ ë§Œë“¤ì–´ì ¸ ìˆê¸° ë•Œë¬¸ì— ë‹¨ì§€ <strong>Repository</strong>ì— êµ¬í˜„ëœ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë©´ë©ë‹ˆë‹¤. ê·¸ëŸ¼ ê°„ë‹¨í•œ ì‹¤ìŠµì„ í†µí•´ <strong>Spring Data JPA</strong>ì— ëŒ€í•´ ë” ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="2-ì‹¤ìŠµí•˜ê¸°">2. ì‹¤ìŠµí•˜ê¸°</h2>
<p>ë¨¼ì € ì‹¤ìŠµí™˜ê²½ì— ëŒ€í•´ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
<ul>
  <li>Spring Boot2.2.4.RELEASE</li>
  <li>Maven</li>
  <li>Oracle(DB)
    <blockquote>
      <p>Oracleì„ ì‚¬ìš©í•œ ì´ìœ ëŠ” H2ë§Œ ì‚¬ìš©í•˜ë‹¤ë³´ë‹ˆ ì‚¬ìš©í•˜ê³  ì‹¶ì—ˆìŠµë‹ˆë‹¤â€¦ ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì…”ë„ ìƒê´€ì—†ìŠµë‹ˆë‹¤.</p>
    </blockquote>
  </li>
</ul>

<p><strong>Maven Dependency</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.oracle<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>ojdbc6<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.zaxxer<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>HikariCP<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.6.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ì˜ì¡´ì„±ì€ ë¨¼ì € <strong>Oracle</strong>ë°ì´í„°ë² ì´ìŠ¤ì™€ <strong>HikariCP</strong>ë¥¼ ì¶”ê°€ í–ˆìŠµë‹ˆë‹¤. <strong>HikariCP</strong>ëŠ” ì»¤ë„¥ì…˜í’€ì˜ ì„¤ì •ì„ ë„ì™€ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ê·¸ ë‹¤ìŒ <strong>Spring data jpa</strong>ì™€ <strong>lombok</strong>ì„ ì¶”ê°€ í–ˆìŠµë‹ˆë‹¤.</p>

<p><strong>applicaion.properties</strong></p>
<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c"># Oracle settings
</span><span class="py">spring.datasource.url</span><span class="p">=</span><span class="s">jdbc:oracle:thin:@localhost:1521:xe</span>
<span class="py">spring.datasource.username</span><span class="p">=</span><span class="s">JPA_TEST</span>
<span class="py">spring.datasource.password</span><span class="p">=</span><span class="s">a1234</span>
<span class="py">spring.datasource.driver-class-name</span><span class="p">=</span><span class="s">oracle.jdbc.driver.OracleDriver</span>
<span class="py">spring.jpa.show-sql</span><span class="p">=</span><span class="s">true</span>

<span class="c"># Hikari CP settings
</span><span class="py">spring.datasource.hikari.connection-timeout</span><span class="p">=</span><span class="s">600000</span>
<span class="py">spring.datasource.hikari.maximum-pool-size</span><span class="p">=</span><span class="s">5</span>

<span class="c"># logging
</span><span class="py">logging.pattern.console</span><span class="p">=</span><span class="s">%d{yyyy-MM-dd HH:mm:ss} %-5level %logger{36} - %msg%n</span>
<span class="py">logging.level.org.hibernate.SQL</span><span class="p">=</span><span class="s">debug</span>
<span class="c">#logging.level.org.hibernate.type.descriptor.sql=trace
</span><span class="py">logging.level.</span><span class="p">=</span><span class="s">error</span>

<span class="c"># Server port
</span><span class="py">server.port</span><span class="p">=</span><span class="s">8081</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>#Oracle settingsì—ì„œ Oracle ë°ì´í„°ë² ì´ìŠ¤ì™€ ê´€ë ¨ëœ ì„¤ì •ì„ í•´ì¤ë‹ˆë‹¤. ì„œë²„í¬íŠ¸ë¥¼ ë³€ê²½í•œ ê²ƒì€ Oracleì´ 8080í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë³€ê²½í•´ ì¤¬ìŠµë‹ˆë‹¤.</p>

<p>ê·¸ ë‹¤ìŒ Oracleì— Tableê³¼ Sequenceë¥¼ ìƒì„±í•´ ì¤¬ìŠµë‹ˆë‹¤.</p>
<pre><code class="language-SQL">CREATE TABLE MEMBER(
    id NUMBER PRIMARY KEY,
	NAME VARCHAR2(255),
	EMAIL VARCHAR2(255),
	UPDATE_TIME TIMESTAMP
);

CREATE SEQUENCE MEMBER_SEQ
START WITH 1
INCREMENT BY 1
NOCYCLE
NOCACHE;
</code></pre>

<p>ê·¸ ë‹¤ìŒ Member ì—”í„°í‹°ë¥¼ ìƒì„±í•´ ì¤ë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="nd">@Entity</span>
<span class="nd">@Getter</span> <span class="nd">@Setter</span> <span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">SEQUENCE</span><span class="o">,</span> <span class="n">generator</span> <span class="o">=</span> <span class="s">"MEM_SEQ"</span><span class="o">)</span>
    <span class="nd">@SequenceGenerator</span><span class="o">(</span><span class="n">sequenceName</span> <span class="o">=</span> <span class="s">"MEMBER_SEQ"</span><span class="o">,</span> <span class="n">allocationSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"MEM_SEQ"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">updateTime</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Member</span><span class="o">(){</span>
        <span class="k">if</span><span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">updateTime</span><span class="o">)){</span>
            <span class="k">this</span><span class="o">.</span><span class="na">updateTime</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>@Idë°‘ì— ìˆëŠ” @GeneratedValueì™€ @SequenceGeneratorë¥¼ ì´ìš©í•´ì„œ Oracleì˜ ì‹œí€€ìŠ¤ì™€ ë§¤í•‘í•´ì¤¬ìŠµë‹ˆë‹¤. updateTimeì„ ë³´ì‹œë©´ í…Œì´ë¸”ì˜ UPDATE_TIMEê³¼ ì´ë¦„ì´ ë‹¤ë¥¸ ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” Entityì—ì„œ Camel Caseë¡œ ì‘ì„±í•˜ê²Œ ë˜ë©´ Defaultê°€ â€˜_â€˜ë¡œ í•©ì³ì§„ í˜•íƒœì˜ ì»¬ëŸ¼ëª…ê³¼ ë§¤í•‘ì„ ì‹œë„í•˜ê²Œ ë©ë‹ˆë‹¤.<br />
ë§ˆì§€ë§‰ìœ¼ë¡œ Repositoryë¥¼ ìƒì„±í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ì•„ë¬´ê²ƒë„ êµ¬í˜„í•˜ì§€ ì•Šê³  <strong>JpaRepositoryë¥¼</strong> ìƒì†ë°›ê¸°ë§Œ í•œ ìƒíƒœì…ë‹ˆë‹¤. ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="nd">@SpringBootTest</span>
<span class="kd">class</span> <span class="nc">MemberRepositoryTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="nc">MemberRepository</span> <span class="n">memberRepository</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Member ì €ì¥"</span><span class="o">)</span>
    <span class="kt">void</span> <span class="nf">memberSaveTest</span><span class="o">(){</span>
        <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"jongmin"</span><span class="o">);</span>
        <span class="n">member</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">"test@test.com"</span><span class="o">);</span>

        <span class="nc">Member</span> <span class="n">member1</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"jongmin"</span><span class="o">,</span> <span class="n">member1</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ê°’ì´ ë“¤ì–´ê°„ ê²ƒì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ <strong>save</strong>í›„ Memberì—”í„°í‹°ë¡œ ë¦¬í„´ì„ ë°›ì•„ ê¸°ì¡´ì˜ ê°’ê³¼ ë¹„êµë¥¼ ì§„í–‰í•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” <strong>saveí›„ ì €ì¥í•œ ê°ì²´ë¥¼ ë¦¬í„´</strong>í•´ì£¼ê¸° ë•Œë¬¸ì— ë¹„êµë¥¼ ì§„í–‰í•œ ê²ƒ ì…ë‹ˆë‹¤. ì´ì œ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ë„ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"Member ì¡°íšŒ"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">findMemberJongminTest</span><span class="o">(){</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>

    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"jongmin"</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>findById</strong>ë¥¼ ì´ìš©í•˜ì—¬ ì•ì—ì„œ ì €ì¥í•œ ê°’ì„ ì¡°íšŒí•˜ì—¬ ë¹„êµí•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. <strong>findById</strong>ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Optional<T> íƒ€ì…ìœ¼ë¡œ ë¦¬í„´í•´ ì¤ë‹ˆë‹¤. ê·¸ëŸ°ë° ì—¬ê¸°ì„œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤. ë§Œì•½ ë‚´ê°€ ì´ë¦„ê³¼ ì´ë©”ì¼ë¡œ ì¡°íšŒë¥¼ í•˜ê³ ì‹¶ë‹¤ë©´? ê¸°ì¡´ì—ëŠ” ì´ëŸ¬í•œ ë©”ì†Œë“œê°€ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë§Œë“¤ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤. ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</T></p>
<h4 id="1-ë©”ì†Œë“œ-ì´ìš©">1. ë©”ì†Œë“œ ì´ìš©</h4>
<p>MemberRepositoryì— ë‹¤ìŒì„ ì¶”ê°€í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByNameAndAndEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">);</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<blockquote>
  <p>ì—¬ê¸°ì„œ ê°’ì´ ì—¬ëŸ¬ê°œì¼ ê²½ìš°ëŠ” List<Member>ë¡œ êµ¬í˜„í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</Member></p>
</blockquote>

<p>ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"ë©”ì†Œë“œ ì´ìš©"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">findMemberByMethod</span><span class="o">(){</span>
    <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"jongmin"</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">email</span> <span class="o">=</span> <span class="s">"test@test.com"</span><span class="o">;</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findByNameAndAndEmail</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">email</span><span class="o">);</span>

    <span class="n">assertEquals</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="n">email</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getEmail</span><span class="o">());</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>ë”±íˆ ë‹¤ë¥¸ê±´ êµ¬í˜„í•˜ì§€ ì•Šì•˜ëŠ”ë° ì˜ ê°’ì´ ì¶œë ¥ë©ë‹ˆë‹¤. Spring Data JPAì—ì„œ ì§€ì›í•´ì£¼ëŠ” ê°•ë ¥í•œ ê¸°ëŠ¥ ë•Œë¬¸ì— ê°€ëŠ¥í•œ ì¼ì…ë‹ˆë‹¤.<br />
<strong>Spring Data JPA</strong>ì—ì„œëŠ” ë©”ì„œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ì§ì ‘ íŒŒìƒì‹œí‚¬ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì ‘ë‘ì‚¬ ìŠ¤íŠ¸ë¦¼ <strong>find..By, read..By, query..By, count..By, get..Byì™€ And, Or</strong>ë“±ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª‡ê°€ì§€ ì˜ˆì‹œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<ul>
  <li>List<Member> findDistinctNameById(Long id)</Member></li>
  <li>List<Member> findByNameIgnoreCase(String name)</Member></li>
  <li>List<Member> findByNameOrderByNameDesc(String name)</Member></li>
</ul>

<p>ìœ„ì™€ ê°™ì´ ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ì—¬ ì¿¼ë¦¬ë¥¼ íŒŒìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. <strong>Between, Like, GraterThan</strong>ë“± ë‹¤ì–‘í•œ ì¿¼ë¦¬ë¥¼ ì¡°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜ì´ì§•ì„ í•  ë•Œë„ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©ê°€ëŠ¥ í•©ë‹ˆë‹¤.</p>

<ul>
  <li>List<Member> findTop10ByName(String name, Pageable pageable)</Member></li>
  <li>List<Member> findFirstByName(String name, Sort sort)</Member></li>
</ul>

<p>ìœ„ì˜ <strong>Topì„ ì´ìš©í•˜ì—¬ Top and</strong>ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆê³  <strong>First(Default: 1)</strong>ë¥¼ ì´ìš©í•˜ì—¬ ê²°ê³¼í¬ê¸°ë¥¼ ì œí•œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì™¸ì—ë„ ë‹¤ì–‘í•œ ì‚¬ìš©ë²•ì´ ìˆìŠµë‹ˆë‹¤.(ë˜í¼ëŸ°ìŠ¤ë¥¼ ì°¸ê³ í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.)</p>

<h4 id="2-query-ì‚¬ìš©">2. @Query ì‚¬ìš©</h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MemberRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findByNameAndAndEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">);</span>

    <span class="nd">@Query</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT m.* FROM MEMBER m WHERE m.email = ?1"</span><span class="o">,</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findMemberUseEmailAddress</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">);</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>@Query ì–´ë…¸í…Œì´ì…˜</strong>ì„ ì‚¬ìš©í•´ì„œ ì§ì ‘ì¿¼ë¦¬ë¥¼ ì…ë ¥í–ˆìŠµë‹ˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"ì¿¼ë¦¬ ì´ìš©"</span><span class="o">)</span>
<span class="kt">void</span> <span class="nf">findMemberByEmail</span><span class="o">(){</span>
    <span class="nc">String</span> <span class="n">email</span> <span class="o">=</span> <span class="s">"test@test.com"</span><span class="o">;</span>
    <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">member</span> <span class="o">=</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findMemberUseEmailAddress</span><span class="o">(</span><span class="n">email</span><span class="o">);</span>

    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"jongmin"</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì¿¼ë¦¬ê°€ ì •ìƒ ì‘ë™í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‘˜ ì¤‘ì— ì–´ëŠ ê²ƒì„ ì“¸ê±´ì§€ëŠ” ìƒí™©ì— ë”°ë¼ ê²°ì •í•´ì•¼ í•œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ë³µì¡í•œ ì¿¼ë¦¬ê°€ ìˆë‹¤ë©´ ì§ì ‘ ì‘ì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ë„ ìˆê¸° ë•Œë¬¸ì´ì£ .</p>

<p>ì´ì™¸ì—ë„ <strong>í˜ì´ì§•</strong>ì„ í•˜ê±°ë‚˜ <strong>íŠ¸ëœì­ì…˜</strong>ì„ ë‹¤ë£¨ëŠ” ê²ƒ ë˜ëŠ” <strong>í”„ë¡œì‹œì ¸</strong>ë¥¼ ë“±ë¡í•˜ëŠ” ê²ƒë“± JPAì—ëŠ” ì •ë§ ë§ì€ ì‚¬ìš©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ê¸°ì„œëŠ” ê¸°ì´ˆë§Œ ë‹¤ë¤˜ê¸° ë•Œë¬¸ì— Spring Referenceë¥¼ ì°¸ê³  í•˜ì…”ì„œ ë¶€ì¡±í•œ ë¶€ë¶„ì€ ë´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤. ì‚¬ì‹¤ ì €ë„ ê³µë¶€ê°€ ë” í•„ìš”í•œ ë‹¨ê³„ë¼ ë§ì´ ë‹¤ë£¨ì§€ ëª»í–ˆìŠµë‹ˆë‹¤â€¦ ì¶”í›„ì— ê³µë¶€í•˜ê²Œ ëœë‹¤ë©´ í¬ìŠ¤íŒ…í•˜ê² ìŠµë‹ˆë‹¤. ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì˜ëª»ëœ ì ì´ë‚˜ ê¶ê¸ˆí•œ ì ì€ ì–¸ì œë“  ë§ì”€í•´ ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.</p>

<p>ì „ì²´ ì½”ë“œëŠ” <a href="https://github.com/JongMinLee0/spring-data-jpa">Github</a>ì—ì„œ í™•ì¸í•´ë³´ì‹¤ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h5 id="ì°¸ê³ ">ì°¸ê³ </h5>
<ul>
  <li>Spring Reference(https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.repositories)</li>
  <li>Spring Guide(https://spring.io/guides/gs/accessing-data-jpa/)</li>
</ul>
:ET